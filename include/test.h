#include "firewall.h"

/* SPD configuration data */
rule_entry inbound_spd_config[10] = {
    /*            source                            destination                       protocol          ports         policy          SA pointer
     *            address          network          address          network                            src    dest                              */
    FW_ENTRY(192, 168, 1, 0, 255, 255, 255, 0, 192, 168, 1, 3, 255, 255, 255, 255, 0, 0, 0, POLICY_BYPASS, 0),
    EMPTY_FW_ENTRY,
    EMPTY_FW_ENTRY,
    EMPTY_FW_ENTRY,
    EMPTY_FW_ENTRY,
    EMPTY_FW_ENTRY,
    EMPTY_FW_ENTRY,
    EMPTY_FW_ENTRY};

/***************************/
/* outbound configurations */
/***************************/

/* SPD configuration data */
rule_entry outbound_spd_config[10] = {
    /*            source                            destination                       protocol          ports         policy          SA pointer
     *            address          network          address          network                            src    dest                              */
    FW_ENTRY(192, 168, 1, 3, 255, 255, 255, 255, 192, 168, 1, 0, 255, 255, 255, 0, 0, 0, 0, POLICY_BYPASS, 0),
    EMPTY_FW_ENTRY,
    EMPTY_FW_ENTRY,
    EMPTY_FW_ENTRY,
    EMPTY_FW_ENTRY,
    EMPTY_FW_ENTRY,
    EMPTY_FW_ENTRY,
    EMPTY_FW_ENTRY};

/*
UDP Source Address: 1.1.1.1 Destination Address: 2.2.2.2

02 02 02 02 02 02 01 01 01 01 01 01 08 00 45 00 00 35 12 34 00 00 FF 11 A3 7E 01 01 01 01 02 02 02 02 02 6F
02 6F 00 21 70 7E 06 00 FF 07 00 33 00 00 00 EA EB 9C 0B 0B 20 28 B8 81 B4 11 FE AA 02 16 FA
*/
unsigned char test_sample_outer_packet[] =
    {
        // Ethernet Header
        // 0x00, 0xA0, 0x24, 0x15, 0x3E, 0x12, 0x00, 0xE0, 0x29, 0x25, 0x60, 0x6C, 0x08, 0x00,
        // inner packet
        0x45,
        0x00,
        0x00,
        0x3C,
        0xE7,
        0x7A,
        0x40,
        0x00,
        0x40,
        0x06,
        0xCF,
        0xC5,
        0xC0,
        0xA8,
        0x01,
        0x28,
        0xC0,
        0xA8,
        0x01,
        0x03,
        0x80,
        0x1A,
        0x00,
        0x50,
        0x84,
        0xB9,
        0xC5,
        0x66,
        0x00,
        0x00,
        0x00,
        0x00,
        0xA0,
        0x02,
        0x7E,
        0xB8,
        0x1F,
        0x75,
        0x00,
        0x00,
        0x02,
        0x04,
        0x3F,
        0x5C,
        0x04,
        0x02,
        0x08,
        0x0A,
        0x00,
        0x0F,
        0x22,
        0x1C,
        0x00,
        0x00,
        0x00,
        0x00,
        0x01,
        0x03,
        0x03,
        0x00,
};

unsigned char test_sample_inner_packet[] =
    {
        // IP Header
        //	0x45, 0x00,
        //    0x00, 0x68, 0x79, 0x9C, 0x00, 0x00, 0x40, 0x33, 0x7D, 0x4B, 0xC0, 0xA8, 0x01, 0x28, 0xC0, 0xA8,
        //    0x01, 0x03,
        // inner packet
        0x45,
        0x00,
        0x00,
        0x3C,
        0xE7,
        0x7A,
        0x40,
        0x00,
        0x40,
        0x06,
        0xCF,
        0xC5,
        0xC0,
        0xA8,
        0x01,
        0x28,
        0xC0,
        0xA8,
        0x01,
        0x03,
        0x80,
        0x1A,
        0x00,
        0x50,
        0x84,
        0xB9,
        0xC5,
        0x66,
        0x00,
        0x00,
        0x00,
        0x00,
        0xA0,
        0x02,
        0x7E,
        0xB8,
        0x1F,
        0x75,
        0x00,
        0x00,
        0x02,
        0x04,
        0x3F,
        0x5C,
        0x04,
        0x02,
        0x08,
        0x0A,
        0x00,
        0x0F,
        0x22,
        0x1C,
        0x00,
        0x00,
        0x00,
        0x00,
        0x01,
        0x03,
        0x03,
        0x00,
};

/*
 * Sent from 192.168.1.3 to 192.168.1.5
 *
 */
unsigned char ah_test_sample_ping_reply_packet[] =
    {

        // IP Header
        0x45,
        0x00,
        0x00,
        0x54,
        0x00,
        0x00,
        0x40,
        0x00,
        0x40,
        0x01,
        0xB7,
        0x50,
        0xC0,
        0xA8,
        0x01,
        0x03,
        0xC0,
        0xA8,
        0x01,
        0x05,
        0x00,
        0x00,
        0x2A,
        0xCD,
        0x86,
        0x04,
        0x00,
        0x00,
        0x3F,
        0xBC,
        0x96,
        0x8E,
        0x00,
        0x04,
        0x8D,
        0xDC,
        0x08,
        0x09,
        0x0A,
        0x0B,
        0x0C,
        0x0D,
        0x0E,
        0x0F,
        0x10,
        0x11,
        0x12,
        0x13,
        0x14,
        0x15,
        0x16,
        0x17,
        0x18,
        0x19,
        0x1A,
        0x1B,
        0x1C,
        0x1D,
        0x1E,
        0x1F,
        0x20,
        0x21,
        0x22,
        0x23,
        0x24,
        0x25,
        0x26,
        0x27,
        0x28,
        0x29,
        0x2A,
        0x2B,
        0x2C,
        0x2D,
        0x2E,
        0x2F,
        0x30,
        0x31,
        0x32,
        0x33,
        0x34,
        0x35,
        0x36,
        0x37,
};
